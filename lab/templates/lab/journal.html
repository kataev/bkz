{% extends 'core/index.html' %}
{% load bkz %}
{% block head %}
{% endblock %}
{% block script %}
    <script type="text/javascript" src="{{ STATIC_URL }}js/libs/jquery.maskedinput.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/tests.js"></script>
{% endblock %}
{% block title %}Журнал за{% endblock %}
{% block container %}
<div class="container" id='journal'>
    <h1>Журнал</h1>
    <form method="POST" id='form' class='row'>
        {% csrf_token %}
    {% for f in factory %}
    <fieldset class='{{ f.css_class }} {{ f.model|class_name }}'>
    {{ f.management_object }}    
    {{ f.management_form }}  
    <table>
    	<caption><h2>{{ f.caption }}</h2></caption>
    		<thead>
                <tr>
                    {% for field in f.empty_form.visible_fields %}
                        <th>{{ field.label|safe }}</th>
                    {% endfor %}
    			</tr>
    		</thead>
    	<tbody>
    		{% for form in f %}
    			<tr id='{{ form.prefix}}' {% if not forloop.first and not form.instance.pk %}style='display: none;'{% endif %}>
    				{% for f in form.visible_fields %}
                        {% if forloop.first %}
                        <td class="input-prepend">
                            <span class='add-on'>{{ forloop.parentloop.counter }}</span>
                            {% for f in form.hidden_fields %}
                                {{ f }}
                            {% endfor %}
                            {{ f }}
                        </td>
                        {% else %}
                        <td {% include 'bootstrap/errors.html' with errors=f.errors %}>{{ f }}</td>
                        {% endif %}
                    {% endfor %}
    			</tr>
    		{% endfor %}
    	</tbody>
        <tfoot>
        <tr>
            <td colspan="{{ f.0.visible_fields|length }}">
                <a href="#" class="show btn btn-mini">Добавить еще форму</a>
            </td>
        </tr>
        </tfoot>    
    </table>
    </fieldset>
    {% endfor %}
</div>
<div class="form-actions">
        <div class="container">
            <button type="submit" class="btn btn-primary" form="form">
                <i class="icon-ok icon-white"></i> Сохранить изменения
            </button>
            <button type="reset" class="btn" form="form"><i class="icon-ban-circle"></i> Отменить</button>
        </div>
    </div>
{% endblock %}